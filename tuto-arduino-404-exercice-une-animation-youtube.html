<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>[Exercice] Une animation “YouTube” &bull; Le blog d'Eskimon</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link rel="stylesheet" href="/static/css/hljs-monokai.css" />
    <link rel="stylesheet" href="/static/css/style.css" />
    <!-- Google font -->
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/static/images/favicon/favicon.ico">
    <link rel="apple-touch-icon" sizes="57x57" href="/static/images/favicon/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/static/images/favicon/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/static/images/favicon/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/static/images/favicon/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/static/images/favicon/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/static/images/favicon/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/static/images/favicon/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/static/images/favicon/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/static/images/favicon/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="/static/images/favicon/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/static/images/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/static/images/favicon/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/static/images/favicon/favicon-16x16.png">
    <link rel="manifest" href="/static/images/favicon/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/static/images/favicon/ms-icon-144x144.png">


    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-46353906-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-46353906-1');
    </script>

    <meta name="description" content="Un TP consacré à l'application des connaissances relatives à la gestion des entrées/sorties analogiques de l'Arduino en réalisant une petite animation." />

  <meta name="tags" content="arduino" />
  <meta name="tags" content="tuto" />


  <meta property="og:site_name" content="Le blog d'Eskimon">
  <meta property="og:title" content="[Exercice] Une animation “YouTube”">
  <meta property="og:url" content="https://eskimon.fr/tuto-arduino-404-exercice-une-animation-youtube">
  <meta property="og:language" content="fr_FR">
  <meta property="og:type" content="website">

  <meta property="twitter:domain" content="https://eskimon.fr/">
  <meta property="twitter:card" content="summary">
  <meta property="twitter:url" content="https://eskimon.fr/tuto-arduino-404-exercice-une-animation-youtube">
  <meta property="twitter:title" content="[Exercice] Une animation “YouTube”">
<meta property="twitter:description" content="Un TP consacré à l'application des connaissances relatives à la gestion des entrées/sorties analogiques de l'Arduino en réalisant une petite animation.">  <meta property="twitter:site" content="SITENAME">
  <meta property="twitter:creator" content="@eskimon_fr">

  <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" />
  <meta name="DC.publisher" lang="fr" content="Le blog d'Eskimon" />
  <meta name="DC.creator" content="Eskimon" />
  <meta name="DC.type" content="text" />
  <meta name="DC.title" content="[Exercice] Une animation “YouTube”" />
  <meta name="DC.abstract" content="[Exercice] Une animation “YouTube” – Un TP consacré à l'application des connaissances relatives à la gestion des entrées/sorties analogiques de l'Arduino en réalisant une petite animation." />
  <meta name="DC.subject" lang="fr" content="Arduino/D - Les grandeurs analogiques – arduino; tuto" />
<meta name="DC.description" lang="fr" content="Un TP consacré à l'application des connaissances relatives à la gestion des entrées/sorties analogiques de l'Arduino en réalisant une petite animation." />  <meta name="DC.date" content="2013-12-11T18:14:00+01:00" />
  <meta name="DC.format" content="text/html" />
  <meta name="DC.language" content="fr" />
  <meta name="DC.rights" content="CC BY-NC-SA" />

  <script type="application/ld+json">
    [{
        "@context": "http://schema.org",
        "@type": "Article",
        "mainEntityOfPage": {
          "@type": "WebPage",
          "@id": "https://eskimon.fr/tuto-arduino-404-exercice-une-animation-youtube"
        },
        "headline": ""[Exercice] Une animation \u201cYouTube\u201d"",
        "datePublished": "2013-12-11T18:14:00+01:00",
        "image": [
            "https://eskimon.fr/static/images/logo.png"
        ],
        "author": {
            "@type": "Person",
            "name": "Eskimon",
            "image": "https://eskimon.fr/static/images/logo.png"
        },
        "publisher": {
            "@type": "Organization",
            "name": "Eskimon",
            "logo": {
                "@type": "ImageObject",
                "url": "https://eskimon.fr/static/images/logo.png"
            }
        },
        "description": ""Un TP consacr\u00e9 \u00e0 l\u0027application des connaissances relatives \u00e0 la gestion des entr\u00e9es/sorties analogiques de l\u0027Arduino en r\u00e9alisant une petite animation.""
    },
    {
        "@context": "http://schema.org",
        "@type": "BreadcrumbList",
        "itemListElement": [{
            "@type": "ListItem",
            "position": 1,
            "item": {
                "@id": "https://eskimon.fr/category/arduino",
                "name": ""Arduino""
            }
        }
        , {
            "@type": "ListItem",
            "position": 2,
            "item": {
                "@id": "https://eskimon.fr/subcategory/arduino/d-les-grandeurs-analogiques",
                "name": ""D - Les grandeurs analogiques""
            }
        }
        , {
            "@type": "ListItem",
            "position": 3,
            "item": {
                "@id": "https://eskimon.fr/tuto-arduino-404-exercice-une-animation-youtube",
                "name": ""[Exercice] Une animation \u201cYouTube\u201d""
            }
        }]
    }]
    </script>

    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
         (adsbygoogle = window.adsbygoogle || []).push({
              google_ad_client: "ca-pub-2080155902357792",
              enable_page_level_ads: true
         });
    </script>
</head>

<body>
<nav class="navbar navbar-expand-lg navbar-light bg-secondary-l40 py-0">
    <a class="navbar-brand" href="/">
        <img src="/static/images/logo.png" width="20" height="20" alt="">
        Le blog d'Eskimon
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
        <div class="navbar-nav ml-auto">
                <a class="nav-item nav-link active" href="/category/arduino">Arduino</a>
                <a class="nav-item nav-link " href="/category/articles">Articles</a>
                <a class="nav-item nav-link " href="/category/web">Web</a>
        </div>
    </div>
</nav>
    <div class="container-fluid es-verticalfill">
<div class="row">
    <!-- Sidebar -->
    <div class="col-lg-2 d-none d-lg-block sticky-top es-scrollable pt-3 px-1 bg-light es-ul-bordered" id="es-side-summary">
        <nav class="px-2" id="es-side-summary-content">
            <!-- Summary will come here -->
        </nav>
        <hr>
        <!-- Self-promo for ebook -->
        <div class="text-center">
            <h4>Ebook Arduino !</h4>
            <a href="/ebook-tutoriel-arduino.html"><img src="/images/couverture-mini.png" alt="couverture ebook" title="couverture de l'ebook"></a>
        </div>
        <hr>
        <!-- Blog side carree -->
        <div id="es-side-summary-bot-annonce" class="text-center">
            <ins class="adsbygoogle"
                 style="display:inline-block;width:250px;height:250px"
                 data-ad-client="ca-pub-2080155902357792"
                 data-ad-slot="6115810402"></ins>
            <script>
            (adsbygoogle = window.adsbygoogle || []).push({});
            </script>
        </div>
    </div>
    <!-- Main content -->
    <div class="col-md-10 col-lg-8 col-xl-7 offset-md-1 offset-lg-1 offset-xl-1 d-block pt-3" id="es-content">
        <article>
            <!-- Leaderboard head article -->
            <ins class="adsbygoogle"
                style="display:inline-block;width:970px;height:90px"
                data-ad-client="ca-pub-2080155902357792"
                data-ad-slot="7158680773"></ins>
            <script>
            (adsbygoogle = window.adsbygoogle || []).push({});
            </script>
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb bg-white">
                    <li class="breadcrumb-item"><a href="/category/arduino">Arduino</a></li>
                        <li class="breadcrumb-item"><a href="/subcategory/arduino/d-les-grandeurs-analogiques">D - Les grandeurs analogiques</a></li>
                    <li class="breadcrumb-item active" aria-current="page">[Exercice] Une animation “YouTube”</li>
                </ol>
            </nav>
            <header class="es-post-info">
                <h1 class="text-center my-4">[Exercice] Une animation “YouTube”</h1>
            </header>
            <footer class="es-post-info pb-2 mb-2">
                <div class="row align-items-center">
                    <div class="col-auto mr-auto">
                        <span class="vcard author">
                            <a class="" href="/author/eskimon" rel="author">Eskimon</a>
                        </span>
                        ,
                        <time class="" datetime="2013-12-11T18:14:00+01:00" pubdate>
                            le mer. 11 décembre 2013
                        </time>
                            (<a href="https://eskimon.fr/tuto-arduino-404-exercice-une-animation-youtube#disqus_thread" data-disqus-identifier="tuto-arduino-404-exercice-une-animation-youtube">commentaires</a>)
                    </div>
                    <div class="col-auto">
                        <a class="btn btn-outline-primary btn-sm" href="/tag/arduino" rel="tag">arduino</a>
                        <a class="btn btn-outline-primary btn-sm" href="/tag/tuto" rel="tag">tuto</a>
                    </div>
                </div>
            </footer>
            <button type="button" id="sidebarCollapse" class="float-right btn btn-secondary sticky-top d-block d-lg-none">
                Sommaire
            </button>
            <!-- /.post-info -->
            <div class="entry-content">
                <p>
 Dans ce petit exercice, je vous propose de faire une animation que vous avez tous vu au moins une fois dans votre vie : le .gif de chargement YouTube ! Pour ceux qui se posent des questions, nous n’allons pas faire de Photoshop ou quoi que ce soit de ce genre. Non, nous (vous en fait
 <img alt=";)" class="smiley" src="./static/smileys/clin.png"/>
 ) allons le faire … avec des LED ! Alors place à l’exercice !
</p>
<h3 id="sommaire">
 <a aria-hidden="true" href="#sommaire">
  <span class="es-autolink-heading">
  </span>
 </a>
 Sommaire
</h3>
<ul>
 <li>
  <a href="#Énoncé">
   Énoncé
  </a>
 </li>
 <li>
  <p>
   <a href="#solution">
    Solution
   </a>
  </p>
  <ul>
   <li>
    <a href="#le-schéma">
     Le schéma
    </a>
   </li>
   <li>
    <p>
     <a href="#le-code">
      Le code
     </a>
    </p>
    <ul>
     <li>
      <a href="#les-variables-globales">
       Les variables globales
      </a>
     </li>
     <li>
      <a href="#le-setup">
       Le setup
      </a>
     </li>
     <li>
      <a href="#la-loop">
       La loop
      </a>
     </li>
     <li>
      <a href="#les-étapes-de-lanimation">
       Les étapes de l’animation
      </a>
     </li>
     <li>
      <a href="#mise-à-jour-des-led">
       Mise à jour des LED
      </a>
     </li>
     <li>
      <a href="#le-programme-complet">
       Le programme complet
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>
<h3 id="Énoncé">
 <a aria-hidden="true" href="#Énoncé">
  <span class="es-autolink-heading">
  </span>
 </a>
 Énoncé
</h3>
<p>
 Pour clôturer votre apprentissage avec les voies analogiques, nous allons faire un petit exercice pour se détendre. Le but de ce dernier est de réaliser une des animations les plus célèbres de l’internet : le .gif de chargement YouTube (qui est aussi utilisé sur d’autres plateformes et applications).
</p>
<p>
 Nous allons le réaliser avec des LED et faire varier la vitesse de défilement grâce à un potentiomètre. Pour une fois, plutôt qu’une longue explication je vais juste vous donner une liste de composants utiles et une vidéo qui parle d’elle même !
</p>
<div class="text-center">
 <p>
  <strong>
   Bon courage !
  </strong>
 </p>
</div>
<ul>
 <li>
  6 LED + leurs résistances de limitation de courant
 </li>
 <li>
  Un potentiomètre
 </li>
 <li>
  Une Arduino, une breadboard et des fils !
 </li>
</ul>
<div class="text-center">
 <div class="video-container">
  <div class="video-wrapper">
   <iframe allowfullscreen="" frameborder="0" height="315" src="https://www.youtube.com/embed/SyxXHZzCoHY" width="560">
   </iframe>
  </div>
 </div>
</div>
<h3 id="solution">
 <a aria-hidden="true" href="#solution">
  <span class="es-autolink-heading">
  </span>
 </a>
 Solution
</h3>
<h4 id="le-schéma">
 <a aria-hidden="true" href="#le-schéma">
  <span class="es-autolink-heading">
  </span>
 </a>
 Le schéma
</h4>
<p>
 Voici tout d’abord le schéma, car une bonne base électronique permettra de faire un beau code ensuite. Pour tout les lecteurs qui ne pensent qu’aux circuits et ne regardent jamais la version "photo" du montage, je vous invite pour une fois à y faire attention, surtout pour l’aspect géométrique du placement des LED. En passant, dans l’optique de faire varier la luminosité des LED, il faudra les connecter sur les broches PWM (notées avec un '~’).
</p>
<p>
 Le potentiomètre quant à lui sera bien entendu connecté à une entrée analogique (la 0 dans mon cas). Comme toujours, les LED auront leur anode reliées au +5V et seront pilotées par état bas (important de le rappeler pour le code ensuite).
</p>
<div class="custom-block custom-block-spoiler">
 <div class="custom-block-body">
  <figure>
   <img alt="Animation Youtube - Schéma" src="./images/uploaded/tuto-arduino-404-exercice-une-animation-youtube/animation-youtube-schema.png"/>
   <figcaption>
    Animation Youtube - Schéma
   </figcaption>
  </figure>
  <figure>
   <img alt="Animation Youtube - Montage" src="./images/uploaded/tuto-arduino-404-exercice-une-animation-youtube/animation-youtube-montage.png"/>
   <figcaption>
    Animation Youtube - Montage
   </figcaption>
  </figure>
 </div>
</div>
<p>
 Voici le schéma sans code si vous souhaitez faire ce dernier vous-même :
</p>
<div class="video-container">
 <div class="video-wrapper">
  <iframe allowfullscreen="" frameborder="0" height="800" src="https://www.tinkercad.com/embed/9b8W0uB0skv" width="100%">
  </iframe>
 </div>
</div>
<h4 id="le-code">
 <a aria-hidden="true" href="#le-code">
  <span class="es-autolink-heading">
  </span>
 </a>
 Le code
</h4>
<p>
 Alors petit défi avant de regarder la solution… En combien de ligne avez vous réussi à écrire votre code (proprement, sans tout mettre sur une seule ligne, pas de triche !) ? Personnellement je l’ai fait en 23 lignes, en faisant des beaux espaces propres.
 <img alt=";)" class="smiley" src="./static/smileys/clin.png"/>
 Bon allez, trêve de plaisanterie, voici la solution, comme à l’accoutumé dans des balises secrètes…
</p>
<h5 id="les-variables-globales">
 <a aria-hidden="true" href="#les-variables-globales">
  <span class="es-autolink-heading">
  </span>
 </a>
 Les variables globales
</h5>
<p>
 Comme vous devez vous en douter, nous allons commencer par déclarer les différentes broches que nous allons utiliser. Il nous en faut six pour les LED et une pour le potentiomètre de réglage de la vitesse d’animation. Pour des fins de simplicité dans le code, j’ai mis les six sorties dans un tableau. Pour d’autres fins de facilité, j’ai aussi mis les "niveaux" de luminosité dans un tableau de char que j’appellerai "pwm". Dans la balise suivante vous trouverez l’ensemble de ces données :
</p>
<div class="custom-block custom-block-spoiler">
 <div class="custom-block-body">
  <div class="hljs-code-div">
   <div class="hljs-line-numbers">
    <span>
    </span>
    <span>
    </span>
    <span>
    </span>
    <span>
    </span>
    <span>
    </span>
    <span>
    </span>
   </div>
   <pre><code class="hljs language-cpp"> <span class="hljs-comment">// sortie LEDs</span>
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> LED[<span class="hljs-number">6</span>] = {<span class="hljs-number">3</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">9</span>,<span class="hljs-number">10</span>,<span class="hljs-number">11</span>};
<span class="hljs-comment">// niveaux de luminosité utilisé</span>
<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> pwm[<span class="hljs-number">6</span>] = {<span class="hljs-number">255</span>,<span class="hljs-number">210</span>,<span class="hljs-number">160</span>,<span class="hljs-number">200</span>,<span class="hljs-number">220</span>,<span class="hljs-number">240</span>};
<span class="hljs-comment">// potentiometre sur la broche 0</span>
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> potar = <span class="hljs-number">0</span>;
</code></pre>
  </div>
 </div>
</div>
<h5 id="le-setup">
 <a aria-hidden="true" href="#le-setup">
  <span class="es-autolink-heading">
  </span>
 </a>
 Le setup
</h5>
<p>
 Personne ne devrais se tromper dans cette fonction, on est dans le domaine du connu, vu et revu ! Il nous suffit juste de mettre en entrée le potentiomètre sur son convertisseur analogique et en sortie mettre les LED (une simple boucle
 <code>
  for
 </code>
 suffit grace au tableau
 <img alt=";)" class="smiley" src="./static/smileys/clin.png"/>
 ).
</p>
<div class="custom-block custom-block-spoiler">
 <div class="custom-block-body">
  <div class="hljs-code-div">
   <div class="hljs-line-numbers">
    <span>
    </span>
    <span>
    </span>
    <span>
    </span>
    <span>
    </span>
    <span>
    </span>
    <span>
    </span>
    <span>
    </span>
    <span>
    </span>
   </div>
   <pre><code class="hljs language-cpp"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-comment">// le potentiomètre en entrée</span>
    pinMode(potar, INPUT);
    <span class="hljs-comment">// les LEDs en sorties</span>
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">6</span>; i++)
    pinMode(LED[i], OUTPUT);
}
</code></pre>
  </div>
 </div>
</div>
<h5 id="la-loop">
 <a aria-hidden="true" href="#la-loop">
  <span class="es-autolink-heading">
  </span>
 </a>
 La loop
</h5>
<p>
 Passons au cœur du programme, la boucle
 <code>
  loop()
 </code>
 ! Je vais vous la divulguer dès maintenant puis l’expliquer ensuite :
</p>
<div class="custom-block custom-block-spoiler">
 <div class="custom-block-body">
  <div class="hljs-code-div">
   <div class="hljs-line-numbers">
    <span>
    </span>
    <span>
    </span>
    <span>
    </span>
    <span>
    </span>
    <span>
    </span>
    <span>
    </span>
    <span>
    </span>
    <span>
    </span>
    <span>
    </span>
    <span>
    </span>
    <span>
    </span>
    <span>
    </span>
    <span>
    </span>
    <span>
    </span>
    <span>
    </span>
    <span>
    </span>
   </div>
   <pre><code class="hljs language-cpp"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-comment">// étape de l'animation</span>
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">6</span>; i++)
    {
        <span class="hljs-comment">// mise à jour des LEDs</span>
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> n=<span class="hljs-number">0</span>; n&lt;<span class="hljs-number">6</span>; n++)
        {
            analogWrite(LED[n], pwm[(n+i)%<span class="hljs-number">6</span>]);
        }
        <span class="hljs-comment">// récupère le temps</span>
        <span class="hljs-keyword">int</span> temps = analogRead(potar);
        <span class="hljs-comment">// tmax = 190ms, tmin = 20ms</span>
        delay(temps/<span class="hljs-number">6</span> + <span class="hljs-number">20</span>);
    }
}
</code></pre>
  </div>
 </div>
</div>
<p>
 Comme vous pouvez le constater, cette fonction se contente de faire deux boucle. L’une sert à mettre à jour les "phases de mouvements" et l’autre met à jour les PWM sur chacune des LED.
</p>
<h5 id="les-étapes-de-lanimation">
 <a aria-hidden="true" href="#les-étapes-de-lanimation">
  <span class="es-autolink-heading">
  </span>
 </a>
 Les étapes de l’animation
</h5>
<p>
 Comme expliqué précédemment, la première boucle concerne les différentes phases de l’animation. Comme nous avons six LED nous avons six niveaux de luminosité et donc six étapes à appliquer (chaque LED prenant successivement chaque niveau). Nous verrons la seconde boucle après.
</p>
<p>
 Avant de passer à la phase d’animation suivante, nous faisons une petite pause. La durée de cette pause détermine la vitesse de l’animation. Comme demandé dans le cahier des charges, cette durée sera réglable à l’aide d’un potentiomètre. La ligne 9 nous permet donc de récupérer la valeur lue sur l’entrée analogique. Pour rappel, elle variera de 0 à 1023.
</p>
<p>
 Si l’on applique cette valeur directement au délai, nous aurions une animation pouvant aller de très très très rapide (potar au minimum) à très très très lent (delay de 1023 ms) lorsque le potar est dans l’autre sens.
</p>
<p>
 Afin d’obtenir un réglage plus sympa, on fait une petite opération sur cette valeur. Pour ma part j’ai décidé de la diviser par 6, ce qui donne
 <span class="inlineMath">
  <span class="katex">
   <span class="katex-mathml">
    <math>
     <semantics>
      <mrow>
       <mn>
        0
       </mn>
       <mi>
        m
       </mi>
       <mi>
        s
       </mi>
       <mo>
        ≤
       </mo>
       <mi>
        t
       </mi>
       <mi>
        e
       </mi>
       <mi>
        m
       </mi>
       <mi>
        p
       </mi>
       <mi>
        s
       </mi>
       <mo>
        ≤
       </mo>
       <mn>
        1
       </mn>
       <mn>
        7
       </mn>
       <mn>
        0
       </mn>
       <mi>
        m
       </mi>
       <mi>
        s
       </mi>
      </mrow>
      <annotation encoding="application/x-tex">
       0 ms \leq temps \leq 170 ms
      </annotation>
     </semantics>
    </math>
   </span>
   <span aria-hidden="true" class="katex-html">
    <span class="strut" style="height:0.64444em;">
    </span>
    <span class="strut bottom" style="height:0.8388800000000001em;vertical-align:-0.19444em;">
    </span>
    <span class="base">
     <span class="mord">
      0
     </span>
     <span class="mord mathit">
      m
     </span>
     <span class="mord mathit">
      s
     </span>
     <span class="mord rule" style="margin-right:0.2777777777777778em;">
     </span>
     <span class="mrel">
      ≤
     </span>
     <span class="mord rule" style="margin-right:0.2777777777777778em;">
     </span>
     <span class="mord mathit">
      t
     </span>
     <span class="mord mathit">
      e
     </span>
     <span class="mord mathit">
      m
     </span>
     <span class="mord mathit">
      p
     </span>
     <span class="mord mathit">
      s
     </span>
     <span class="mord rule" style="margin-right:0.2777777777777778em;">
     </span>
     <span class="mrel">
      ≤
     </span>
     <span class="mord rule" style="margin-right:0.2777777777777778em;">
     </span>
     <span class="mord">
      1
     </span>
     <span class="mord">
      7
     </span>
     <span class="mord">
      0
     </span>
     <span class="mord mathit">
      m
     </span>
     <span class="mord mathit">
      s
     </span>
    </span>
   </span>
  </span>
 </span>
 . Estimant que 0 ne permet pas de faire une animation (puisqu’on passerait directement à l’étape suivante sans attendre), j’ajoute 20 à ce résultat. Le temps final sera donc compris dans l’intervalle :
 <span class="inlineMath">
  <span class="katex">
   <span class="katex-mathml">
    <math>
     <semantics>
      <mrow>
       <mn>
        2
       </mn>
       <mn>
        0
       </mn>
       <mi>
        m
       </mi>
       <mi>
        s
       </mi>
       <mo>
        ≤
       </mo>
       <mi>
        t
       </mi>
       <mi>
        e
       </mi>
       <mi>
        m
       </mi>
       <mi>
        p
       </mi>
       <mi>
        s
       </mi>
       <mo>
        ≤
       </mo>
       <mn>
        1
       </mn>
       <mn>
        9
       </mn>
       <mn>
        0
       </mn>
       <mi>
        m
       </mi>
       <mi>
        s
       </mi>
      </mrow>
      <annotation encoding="application/x-tex">
       20 ms \leq temps \leq 190 ms
      </annotation>
     </semantics>
    </math>
   </span>
   <span aria-hidden="true" class="katex-html">
    <span class="strut" style="height:0.64444em;">
    </span>
    <span class="strut bottom" style="height:0.8388800000000001em;vertical-align:-0.19444em;">
    </span>
    <span class="base">
     <span class="mord">
      2
     </span>
     <span class="mord">
      0
     </span>
     <span class="mord mathit">
      m
     </span>
     <span class="mord mathit">
      s
     </span>
     <span class="mord rule" style="margin-right:0.2777777777777778em;">
     </span>
     <span class="mrel">
      ≤
     </span>
     <span class="mord rule" style="margin-right:0.2777777777777778em;">
     </span>
     <span class="mord mathit">
      t
     </span>
     <span class="mord mathit">
      e
     </span>
     <span class="mord mathit">
      m
     </span>
     <span class="mord mathit">
      p
     </span>
     <span class="mord mathit">
      s
     </span>
     <span class="mord rule" style="margin-right:0.2777777777777778em;">
     </span>
     <span class="mrel">
      ≤
     </span>
     <span class="mord rule" style="margin-right:0.2777777777777778em;">
     </span>
     <span class="mord">
      1
     </span>
     <span class="mord">
      9
     </span>
     <span class="mord">
      0
     </span>
     <span class="mord mathit">
      m
     </span>
     <span class="mord mathit">
      s
     </span>
    </span>
   </span>
  </span>
 </span>
 .
</p>
<h5 id="mise-à-jour-des-led">
 <a aria-hidden="true" href="#mise-à-jour-des-led">
  <span class="es-autolink-heading">
  </span>
 </a>
 Mise à jour des LED
</h5>
<p>
 La deuxième boucle possède une seule ligne qui est la clé de toute l’animation !
</p>
<p>
 Cette boucle sert à mettre à jour les LED pour qu’elles aient toute la bonne luminosité. Pour cela, on utilisera la fonction analogWrite() (car après tout c’est le but du chapitre !). Le premier paramètre sera le numéro de la LED (grâce une fois de plus au tableau) et le second sera la valeur du PWM. C’est pour cette valeur que toute l’astuce survient.
</p>
<p>
 En effet, j’utilise une opération mathématique un peu particulière que l’on appelle
 <strong>
  modulo
 </strong>
 . Pour ceux qui ne se rappelle pas de ce dernier, nous l’avons vu il y a très longtemps dans la première partie, deuxième chapitres sur
 <a href="https:// zestedesavoir.com/tutoriels/537/arduino-premiers-pas-en-informatique-embarquee/742/decouverte-de-larduino/3418/le-langage-arduino-12/#2-les-variables">
  les variables
 </a>
 . Cet opérateur permet de donner le résultat de la division euclidienne (mais je vous laisse aller voir le cours pour plus de détail). Pour obtenir la bonne valeur de luminosité il me faut lire la bonne case du tableau pwm[].
</p>
<p>
 Ayant six niveaux de luminosité, j’ai six case dans mon tableau. Mais comment obtenir le bonne ? Eh bien simplement en additionnant le numéro de la LED en train d’être mise à jour (donné par la seconde boucle) et le numéro de l’étape de l’animation en cours (donné par la première boucle). Seulement imaginons que nous mettions à jour la sixième LED (indice 5) pour la quatrième étape (indice 3). Ça nous donne 8. Hors 8 est plus grand que 6 (L’index 5 est la sixième led). En utilisant le modulo, nous prenons le reste de la division de 8/6 soit 2. Il nous faudra donc utiliser la case numéro 2 du tableau pwm[] pour cette utilisation.
 <em>
  Tout simplement
 </em>
 <img alt=":p" class="smiley" src="./static/smileys/langue.png"/>
</p>
<div class="custom-block alert alert-primary">
 <div class="custom-block-body">
  <p>
   Je suis conscient que cette écriture n’est pas simple. Il est tout a fait normal de ne pas l’avoir trouvé et demande une certaine habitude de la programmation et ses astuces pour y penser.
  </p>
 </div>
</div>
<p>
 Pour ceux qui se demande encore quel est l’intérêt d’utiliser des tableaux de données, voici deux éléments de réponse.
</p>
<ul>
 <li>
  Admettons j’utilise une Arduino Mega qui possède 15 pwm, j’aurais pu allumer 15 LEDs dans mon animation. Mais si j’avais fait mon setup de manière linéaire, il m’aurait fallu rajouter 9 lignes. Grâce au tableau, j’ai juste besoin de les ajouter à ce dernier et de modifier l’indice de fin pour l’initialisation dans la boucle
  <code>
   for
  </code>
  .
 </li>
 <li>
  La même remarque s’applique à l’animation. En modifiant simplement les tableaux je peux changer rapidement l’animation, ses niveaux de luminosité, le nombre de LEDs, l’ordre d’éclairage etc…
 </li>
</ul>
<h5 id="le-programme-complet">
 <a aria-hidden="true" href="#le-programme-complet">
  <span class="es-autolink-heading">
  </span>
 </a>
 Le programme complet
</h5>
<p>
 Et pour tout ceux qui doute du fonctionnement du programme, voici dès maintenant le code complet de la machine ! (Attention lorsque vous faites vos branchement à mettre les LED dans le bon ordre, sous peine d’avoir une séquence anarchique).
</p>
<div class="custom-block custom-block-spoiler">
 <div class="custom-block-body">
  <div class="hljs-code-div">
   <div class="hljs-line-numbers">
    <span>
    </span>
    <span>
    </span>
    <span>
    </span>
    <span>
    </span>
    <span>
    </span>
    <span>
    </span>
    <span>
    </span>
    <span>
    </span>
    <span>
    </span>
    <span>
    </span>
    <span>
    </span>
    <span>
    </span>
    <span>
    </span>
    <span>
    </span>
    <span>
    </span>
    <span>
    </span>
    <span>
    </span>
    <span>
    </span>
    <span>
    </span>
    <span>
    </span>
    <span>
    </span>
    <span>
    </span>
    <span>
    </span>
    <span>
    </span>
    <span>
    </span>
    <span>
    </span>
    <span>
    </span>
    <span>
    </span>
    <span>
    </span>
    <span>
    </span>
   </div>
   <pre><code class="hljs language-cpp"><span class="hljs-comment">// sortie LEDs</span>
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> LED[<span class="hljs-number">6</span>] = {<span class="hljs-number">3</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">9</span>,<span class="hljs-number">10</span>,<span class="hljs-number">11</span>};
<span class="hljs-comment">// niveaux de luminosité utilisé</span>
<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> pwm[<span class="hljs-number">6</span>] = {<span class="hljs-number">255</span>,<span class="hljs-number">210</span>,<span class="hljs-number">160</span>,<span class="hljs-number">200</span>,<span class="hljs-number">220</span>,<span class="hljs-number">240</span>};
<span class="hljs-comment">// potentiometre sur la broche 0</span>
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> potar = <span class="hljs-number">0</span>;

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span>
</span>{
    pinMode(potar, INPUT);
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">6</span>; i++)
        pinMode(LED[i], OUTPUT);
}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-comment">// étape de l'animation</span>
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">6</span>; i++)
    {
        <span class="hljs-comment">// mise à jour des LEDs</span>
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> n=<span class="hljs-number">0</span>; n&lt;<span class="hljs-number">6</span>; n++)
        {
            analogWrite(LED[n], pwm[(n+i)%<span class="hljs-number">6</span>]);
        }
        <span class="hljs-comment">// récupère le temps</span>
        <span class="hljs-keyword">int</span> temps = analogRead(potar);
        <span class="hljs-comment">// tmax = 190ms, tmin = 20ms</span>
        delay(temps/<span class="hljs-number">6</span> + <span class="hljs-number">20</span>);
    }
}
</code></pre>
  </div>
 </div>
</div>
<p>
 Et voici la solution sur simulateur :
</p>
<div class="video-container">
 <div class="video-wrapper">
  <iframe allowfullscreen="" frameborder="0" height="800" src="https://www.tinkercad.com/embed/6cSEQY3m7mQ" width="100%">
  </iframe>
 </div>
</div>
<p>
 La mise en bouche des applications possibles avec les entrées/sortie PWM est maintenant terminée. Je vous laisse réfléchir à ce que vous pourriez faire avec. Tenez, d’ailleurs les chapitres de la partie suivante utilisent ces entrées/sorties et ce n’est pas par hasard…
 <img alt=";)" class="smiley" src="./static/smileys/clin.png"/>
</p>
            </div>
            <!-- /.entry-content -->
            <hr>
            <div class="row bg-light my-2 py-2 rounded">
                <div class="col mr-auto">
                    <a class="" href="/tuto-arduino-403-et-les-sorties-analogiques-enfin-presque" rel="prev">
                        <i class="fas fa-chevron-left fa-lg"></i>
                        tuto-arduino-403-et-les-sorties-analogiques-enfin-presque
                    </a>
                </div>
                <div class="col-auto">
                    <a class="" href="/tuto-arduino-501-généralités-sur-les-capteurs" rel="next">
                        tuto-arduino-501-généralités-sur-les-capteurs
                        <i class="fas fa-chevron-right fa-lg"></i>
                    </a>
                </div>
            </div>
            <div class="text-center">
                <img class="es-licence-pic" src="/static/images/CC BY-NC-SA.png" alt="Licence CC BY-NC-SA" title="Article sous licence CC BY-NC-SA">
            </div>
            <div class="my-3 text-center">
                <a class="btn btn-outline-dark mx-1" href="https://twitter.com/share?url=https://eskimon.fr/tuto-arduino-404-exercice-une-animation-youtube&amp;text=[Exercice] Une animation “YouTube” - https://eskimon.fr/tuto-arduino-404-exercice-une-animation-youtube" rel="nofollow" title="Partager cet article sur Twitter" role="button" data-toggle="tooltip" data-placement="top">
                    <i class="fab fa-twitter fa-lg"></i>
                </a>
                <a class="btn btn-outline-dark mx-1" href="https://www.facebook.com/sharer.php?u=https://eskimon.fr/tuto-arduino-404-exercice-une-animation-youtube&amp;t=[Exercice] Une animation “YouTube” - https://eskimon.fr/tuto-arduino-404-exercice-une-animation-youtube" rel="nofollow" title="Partager cet article sur Facebook" role="button" data-toggle="tooltip" data-placement="top">
                    <i class="fab fa-facebook-f fa-lg"></i>
                </a>
                <a class="btn btn-outline-dark mx-1" href="https://plus.google.com/share?url=https://eskimon.fr/tuto-arduino-404-exercice-une-animation-youtube&amp;hl=fr" rel="nofollow" title="Partager cet article sur Google +" role="button" data-toggle="tooltip" data-placement="top">
                    <i class="fab fa-google-plus fa-lg"></i>
                </a>
                <!--<a class="btn btn-outline-dark mx-1" href="http://sharetodiaspora.github.io/?url=https://eskimon.fr/tuto-arduino-404-exercice-une-animation-youtube&amp;title=[Exercice] Une animation “YouTube” - https://eskimon.fr/tuto-arduino-404-exercice-une-animation-youtube" rel="nofollow"  title="Partager cet article sur Diaspora" role="button" data-toggle="tooltip" data-placement="top">
                    <i class="fab fa-google-plus fa-lg"></i>
                </a>-->
                <a class="btn btn-outline-dark mx-1" href="mailto:?subject=[Exercice] Une animation “YouTube”&amp;body=https://eskimon.fr/tuto-arduino-404-exercice-une-animation-youtube"rel="nofollow" title="Partager cet article par email" role="button" data-toggle="tooltip" data-placement="top">
                    <i class="far fa-envelope fa-lg"></i>
                </a>
            </div>
            <hr>
            <div class="text-center">
                <!-- billboard horizontal fin article -->
                <ins class="adsbygoogle" style="display:inline-block;width:970px;height:250px" data-ad-client="ca-pub-2080155902357792" data-ad-slot="6471099302"></ins>
                <script>
                    (adsbygoogle = window.adsbygoogle || []).push({});
                </script>
            </div>
            <!-- disqus start -->
            <div id="disqus_thread"></div>
            <script>
                var disqus_config = function () {
                    this.page.url = 'https://eskimon.fr/tuto-arduino-404-exercice-une-animation-youtube';
                    this.page.identifier = 'tuto-arduino-404-exercice-une-animation-youtube';
                    this.page.title = '[Exercice] Une animation “YouTube”';
                };
                (function () { // DON'T EDIT BELOW THIS LINE
                    var d = document, s = d.createElement('script');
                    s.src = 'https://eskimon-fr.disqus.com/embed.js';
                    s.setAttribute('data-timestamp', +new Date());
                    (d.head || d.body).appendChild(s);
                })();
            </script>
            <noscript>Please enable JavaScript to view the
                <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
            </noscript>
            <!-- disqus end -->
        </article>
    </div>
    <div class="d-none d-xl-block col-xl-1 offset-xl-1 px-0">
        <div class="d-flex flex-column justify-content-around align-items-end h-100" id="es-right-ad-block">
            <!-- Pub ajouté auto -->
        </div>
    </div>
</div>
    </div>
<footer class="container-fluid bg-dark small text-white px-3">
<div class="row">
    <div class="col align-self-center">
        © Eskimon -
        Blog propulsé par <a class="bold text-white" href="https://blog.getpelican.com/" rel="nofollow">Pelican</a> -
        Thème fait maison
    </div>
    <div class="col align-self-end text-right">
        <a class="btn btn-lg text-light" href="https://github.com/Eskimon" rel="nofollow" title="Mon profil Github">
            <i class="fab fa-github fa-lg"></i>
        </a>
        <a class="btn btn-lg text-light" href="https://twitter.com/Eskimon_fr" rel="nofollow" title="Me suivre sur Linkedin">
            <i class="fab fa-twitter fa-lg"></i>
        </a>
    </div>
  </div>
</footer>
    <!-- For formula -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <!-- Font awesome -->
    <script src="https://use.fontawesome.com/releases/v5.0.0/js/all.js"></script>
    <!-- JQuery first -->
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <!-- Popper.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <!-- Bootstrap -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    <!-- For tooltips -->
    <script>$(function () {  $('[data-toggle="tooltip"]').tooltip()})</script>
    <script src="/static/js/my-scripts.js"></script>
<script>
function create_side_summary() {
    // Duplicate summary
    var main_summary = $('#sommaire').next();
    if(main_summary.length === 0)
        return
    var side_summary = main_summary.clone();
    side_summary.addClass('pl-0');
    var all_p = side_summary.find('p');
    all_p.contents().unwrap();
    var all_li = side_summary.find('li');
    all_li.addClass('pl-1');

    // scrollspy - in
    side_summary.attr('id', 'es-side-summary-mainlist');
    //side_summary.addClass('nav');
    //all_li.addClass('nav-item');
    var all_a = side_summary.find('a');
    all_a.addClass('nav-link');
    var all_ul = side_summary.find('ul');
    all_ul.addClass('pl-1');
    $('body').scrollspy({ target: '#es-side-summary-mainlist' });
    // scrollspy - out

    var summary_title = document.createElement("h4");
    summary_title.className = 'navbar-brand';
    summary_title.innerHTML = 'Sommaire';
    $(summary_title).prependTo('#es-side-summary-content');
    side_summary.appendTo('#es-side-summary-content');
    main_summary.addClass('es-subul-collapse');
}

function generate_spoilers() {
    all_secret = $('.custom-block-spoiler');
    all_secret.each(function( index ) {
        let content = $(this).html();
        $(this).html('');
        $(this).addClass('card');
        var headerText = document.createElement("button");
        var cardHeader = document.createElement("div");
        var cardBodyWrapper = document.createElement("div");
        var cardBody = document.createElement("div");
        $(headerText).text('Contenu masqué, cliquez pour afficher');
        $(headerText).addClass('btn btn-link btn-sm');
        $(headerText).attr('data-toggle', 'collapse');
        $(headerText).attr('data-target', '#collapse-' + index);
        $(headerText).attr('aria-controls', 'collapse-' + index);
        $(headerText).attr('aria-expanded', 'false');
        $(cardHeader).append(headerText);
        $(cardHeader).addClass('card-header');
        $(cardHeader).attr('id', 'spoiler-' + index);
        $(cardBody).html(content);
        $(cardBody).addClass('card-body');
        $(cardBodyWrapper).append(cardBody);
        $(cardBodyWrapper).addClass('collapse hide');
        $(cardBodyWrapper).attr('id', 'collapse-' + index)
        $(cardBodyWrapper).attr('aria-labelledby', 'spoiler-' + index)
        $(this).prepend(cardHeader);
        $(this).append(cardBodyWrapper);
    });

    $('.collapse').collapse({toggle: false});
}

function load_extra_ads() {
    return;
    // Load right side blocks
    var sidebar = $('#es-right-ad-block');
    var n_height = Math.floor(sidebar.height() / 2000);
    for (i = 0; i < n_height; i++) {
        var frag = document.createDocumentFragment();
        var newAdBlock = document.createElement("div");
        var block1 = document.createElement("ins");
        var block2 = document.createElement("script");

        block1.innerHTML = '<ins class="adsbygoogle" ' +
            'style="display:inline-block;width:120px;height:600px" ' +
            'data-ad-client="ca-pub-2080155902357792" ' +
            'data-ad-slot="4023722026"></ins>';
        block2.innerHTML = '(adsbygoogle = window.adsbygoogle || []).push({});';

        $(newAdBlock).append(block1);
        $(newAdBlock).append(block2);
        $(frag).append(newAdBlock);

        $(sidebar).append(frag);
    }

    // Load in feed blocks (above every h3)
    var frag = document.createDocumentFragment();
    var newAdBlock = document.createElement("div");
    var block1 = document.createElement("ins");
    var block2 = document.createElement("script");
    block1.innerHTML = '<ins class="adsbygoogle"' +
    'style = "display:inline-block;width:970px;height:90px"' +
    'data - ad - client="ca-pub-2080155902357792"' +
    'data - ad - slot="7100712740" ></ins >'
    block2.innerHTML = '(adsbygoogle = window.adsbygoogle || []).push({});';
    $(newAdBlock).append(block1);
    $(newAdBlock).append(block2);
    newAdBlock.className = 'my-3 text-center';
    $(frag).append(newAdBlock);
    var titles = $('.entry-content h3').slice(1);
    $(frag).insertBefore(titles);
}

$(document).ready(function () {

    create_side_summary();
    generate_spoilers();
    load_extra_ads();

    // when opening the sidebar
    $('#sidebarCollapse').on('click', function () {
        // open sidebar
        $('#es-side-summary').removeClass('d-none');
        $('#es-content').addClass('d-none');
        $('#sidebarCollapse').removeClass('sticky-top');
    });

    // if dismiss or overlay was clicked
    $('#es-side-summary').on('click', function () {
      // hide the sidebar
      $('#es-side-summary').addClass('d-none');
      $('#es-content').removeClass('d-none');
      $('#sidebarCollapse').addClass('sticky-top');
    });
});
</script>

<script id="dsq-count-scr" src="//eskimon-fr.disqus.com/count.js" async></script>
</body>

</html>
